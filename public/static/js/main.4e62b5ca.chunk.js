(this["webpackJsonpreact-rails-api-project-template-client"]=this["webpackJsonpreact-rails-api-project-template-client"]||[]).push([[0],{32:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),s=n(12),i=n.n(s),o=n(4),j=n(11),a=n(10),u=n(48),l=n(1);var b=function(e){var t=e.book,n=e.setLikes,c=e.likes,r=(e.onDelete,e.currentUser);return Object(l.jsxs)("div",{children:[Object(l.jsx)("img",{src:t.img_url,alt:"book"}),Object(l.jsx)("h3",{children:t.title}),Object(l.jsx)("h3",{children:t.author}),Object(l.jsx)(u.a,{onClick:function(){return function(e){var s={user_id:r.id,book_id:t.id,rating:10},i={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)};fetch("/user_books",i).then((function(e){return e.json()})).then((function(e){return n([].concat(Object(a.a)(c),[e]))}))}(t.id)},children:"Add to Likes"})]})};var h=function(e){var t=e.books,n=e.setLikes,c=e.likes,r=e.onDelete,s=e.currentUser;return Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Books to Like "}),Object(l.jsx)("div",{children:t.map((function(e){return Object(l.jsx)(b,{book:e,setLikes:n,likes:c,onDelete:r,currentUser:s})}))})]})},d=n(6),O=n(8);var x=function(e){var t=e.book,n=e.onDeleteLike,r=e.setLikes,s=Object(c.useState)({rating:""}),i=Object(o.a)(s,2),j=i[0],a=i[1];return Object(l.jsxs)("div",{children:[Object(l.jsx)("img",{src:t.book.img_url,alt:"book"}),Object(l.jsx)("h3",{children:t.book.author}),Object(l.jsx)("h3",{children:t.book.title}),Object(l.jsxs)("h3",{children:["Rating: ",t.rating]}),Object(l.jsxs)("form",{onSubmit:function(e){var n={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)};e.preventDefault(),fetch("/user_books/".concat(t.id),n).then((function(e){return e.json()})).then((function(e){return console.log(e)})),fetch("/user_books").then((function(e){return e.json()})).then(r)},children:[Object(l.jsx)("label",{htmlFor:"rating",children:"Rating"}),Object(l.jsx)("input",{type:"text",name:"rating",value:j.rating,onChange:function(e){return function(e){a(Object(O.a)(Object(O.a)({},j),{},Object(d.a)({},e.target.name,e.target.value)))}(e)}}),Object(l.jsx)("button",{type:"submit",children:"Submit Rating"})]}),Object(l.jsx)(u.a,{onClick:function(){return n(t.id)},children:"Delete"})]})};var p=function(e){var t=e.likes,n=e.onDeleteLike,c=e.setLikes;return Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Liked Books"}),Object(l.jsx)("div",{children:t.map((function(e){return Object(l.jsx)("div",{children:Object(l.jsx)(x,{book:e,setLikes:c,onDeleteLike:n})},e.id)}))})]})};var f=function(e){var t=e.setCurrentUser,n=e.currentUser,r=Object(c.useState)([]),s=Object(o.a)(r,2),i=s[0],j=s[1],a=Object(c.useState)([]),u=Object(o.a)(a,2),b=u[0],d=u[1];return Object(c.useEffect)((function(){fetch("/books").then((function(e){return e.json()})).then(j)}),[]),Object(c.useEffect)((function(){fetch("/user_books").then((function(e){return e.json()})).then(d)}),[]),Object(l.jsxs)("div",{children:["Welcome ",n.username,"!",Object(l.jsx)("p",{children:Object(l.jsx)("button",{onClick:function(){t(null),fetch("/logout",{method:"DELETE"})},children:"Logout"})}),Object(l.jsx)(h,{books:i,setLikes:d,likes:b,currentUser:n}),Object(l.jsx)(p,{likes:b,setLikes:d,onDeleteLike:function(e){fetch("/user_books/".concat(e),{method:"DELETE"});var t=b.filter((function(t){return t.id!==e}));d(t)}})]})},m=n(3);var v=function(e){var t=e.setCurrentUser,n=Object(c.useState)({username:"",email:"",password:""}),r=Object(o.a)(n,2),s=r[0],i=r[1],a=function(e){i(Object(O.a)(Object(O.a)({},s),{},Object(d.a)({},e.target.name,e.target.value)))};return Object(l.jsx)("div",{children:Object(l.jsxs)("form",{onSubmit:function(e){var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)};e.preventDefault(),fetch("/login",n).then((function(e){e.ok?e.json().then((function(e){t(e)})):e.json().then((function(e){console.error(e)}))}))},children:[Object(l.jsx)("h1",{children:"Log In"}),Object(l.jsxs)("p",{children:[Object(l.jsx)("label",{htmlFor:"username",children:"Username "}),Object(l.jsx)("input",{type:"text",name:"username",value:s.username,onChange:function(e){return a(e)}})]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("label",{htmlFor:"password",children:"Password "}),Object(l.jsx)("input",{type:"password",name:"password",value:s.password,onChange:function(e){return a(e)}})]}),Object(l.jsx)("p",{children:Object(l.jsx)("button",{type:"submit",children:"Log In"})}),Object(l.jsx)("p",{children:"Don't have an account?"}),Object(l.jsx)("p",{children:Object(l.jsx)(j.b,{to:"/signup",children:"Sign Up"})})]})})};var k=function(e){var t=e.setCurrentUser,n=Object(c.useState)({username:"",email:"",password:""}),r=Object(o.a)(n,2),s=r[0],i=r[1],a=function(e){i(Object(O.a)(Object(O.a)({},s),{},Object(d.a)({},e.target.name,e.target.value)))};return Object(l.jsx)("div",{children:Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)};fetch("/signup",n).then((function(e){e.ok?e.json().then((function(e){console.log(e),t(e)})):e.json().then((function(e){console.error(e)}))}))},children:[Object(l.jsx)("h1",{children:"Sign Up"}),Object(l.jsxs)("p",{children:[Object(l.jsx)("label",{htmlFor:"username",children:"Username "}),Object(l.jsx)("input",{type:"text",name:"username",value:s.username,onChange:function(e){return a(e)}})]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("label",{htmlFor:"email",children:"Email "}),Object(l.jsx)("input",{type:"text",name:"email",value:s.email,onChange:function(e){return a(e)}})]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("label",{htmlFor:"password",children:"Password "}),Object(l.jsx)("input",{type:"password",name:"password",value:s.password,onChange:function(e){return a(e)}})]}),Object(l.jsx)("p",{children:Object(l.jsx)("button",{type:"submit",children:"Sign Up"})}),Object(l.jsx)("p",{children:"Have an account?"}),Object(l.jsx)("p",{children:Object(l.jsx)(j.b,{to:"/",children:"Log In"})})]})})};var g=function(e){var t=e.setCurrentUser;return Object(l.jsx)("div",{children:Object(l.jsxs)(m.c,{children:[Object(l.jsx)(m.a,{exact:!0,path:"/",element:Object(l.jsx)(v,{setCurrentUser:t})}),Object(l.jsx)(m.a,{exact:!0,path:"/signup",element:Object(l.jsx)(k,{setCurrentUser:t})})]})})};var y=function(){var e=Object(c.useState)(null),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(!1),i=Object(o.a)(s,2),a=i[0],u=i[1];return console.log(n),Object(c.useEffect)((function(){fetch("/me",{credentials:"include"}).then((function(e){e.ok?e.json().then((function(e){r(e),u(!0)})):u(!0)}))}),[]),a?Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:"Books App"}),Object(l.jsx)(j.a,{children:n?Object(l.jsx)(f,{setCurrentUser:r,currentUser:n}):Object(l.jsx)(g,{setCurrentUser:r})})]}):Object(l.jsx)("div",{})};i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(y,{})}),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.4e62b5ca.chunk.js.map